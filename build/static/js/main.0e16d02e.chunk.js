(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{126:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(64),c=n.n(r),o=n(11),u=n(12),l=n(14),s=n(13),h=n(15),p=n(7),g=n(20),m=n(3),d=n.n(m),f=n(16),v=n(65),C=n.n(v),w=n(66),b=n.n(w);function j(e){return y.apply(this,arguments)}function y(){return(y=Object(f.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){var n=new Image;n.onload=function(){return e(n)},n.src=t}));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function S(e){var t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0),t}function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return e=parseInt(e),isNaN(e)&&(e=t),e}var T={container:{marginTop:20,borderTop:"1px solid"}},k=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(i)))).state={imgs:[],allSrc:""},n._handleRefContainer=function(e){e&&n._elContainer!==e&&(n._elContainer=e,n._cut())},n._handleClickDownloadAll=Object(f.a)(d.a.mark(function e(){var t,a,i,r,c,o,u,l,s,h,g,m,f,v;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=Object(p.a)(Object(p.a)(n)),a=t.state,i=a.imgs,r=a.allSrc,(c=new C.a).file("all.png",r.slice("data:image/png;base64,".length),{base64:!0}),o=!0,u=!1,l=void 0,e.prev=6,s=i[Symbol.iterator]();!(o=(h=s.next()).done);o=!0)g=h.value,m=g.i,f=g.j,v=g.src,c.file("".concat(f,"-").concat(m,".png"),v.slice("data:image/png;base64,".length),{base64:!0});e.next=14;break;case 10:e.prev=10,e.t0=e.catch(6),u=!0,l=e.t0;case 14:e.prev=14,e.prev=15,o||null==s.return||s.return();case 17:if(e.prev=17,!u){e.next=20;break}throw l;case 20:return e.finish(17);case 21:return e.finish(14);case 22:return e.t1=b.a,e.next=25,c.generateAsync({type:"blob"});case 25:e.t2=e.sent,(0,e.t1)(e.t2,"\u62fc\u56fe");case 27:case"end":return e.stop()}},e,this,[[6,10,14,22],[15,,17,21]])})),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.cutData,t=e.pieceSize,n=e.pieceRowCount,a=e.pieceColumnCount,r=this.state.imgs;return i.a.createElement("div",{style:T.container,ref:this._handleRefContainer},i.a.createElement("button",{onClick:this._handleClickDownloadAll},"\u4e0b\u8f7d\u6240\u6709"),i.a.createElement("div",{style:{position:"relative",width:a*t,height:n*t,margin:200}},r.map(function(e,t){var n=e.top,a=e.left,r=e.size,c=e.src;return i.a.createElement("img",{key:t,src:c,alt:t,style:{position:"absolute",top:n,left:a,width:r,height:r}})})))}},{key:"_cut",value:function(){var e=Object(f.a)(d.a.mark(function e(){var t,n,a,i,r,c,o,u,l,s,h,p,g,m,f;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.cutData,n=t.pieceSize,a=t.pieceRowCount,i=t.pieceColumnCount,r=t.lineWidth,c=t.strokeStyle,e.next=3,this._getImgCanvas();case 3:for(o=e.sent,u=S(o),l=u.getContext("2d"),(s=document.createElement("canvas")).width=s.height=Math.ceil(1.64*n),h=s.getContext("2d"),p=(s.width-n)/2,g=[],l.lineWidth=r,l.strokeStyle=c,m=0;m<i;m++)for(f=0;f<a;f++)l.clearRect(0,0,u.width,u.height),l.save(),l.beginPath(),f?(l.moveTo(m*n,f*n),m+f&1?this._jigsawHTLineTo(l,m+1,f):this._jigsawHBLineTo(l,m+1,f)):(l.moveTo(m*n,f*n-2*r),l.lineTo((m+1)*n,f*n-2*r)),m<i-1?m+f&1?this._jigsawVLLineTo(l,m+1,f+1):this._jigsawVRLineTo(l,m+1,f+1):(l.lineTo((m+1)*n+2*r,f*n),l.lineTo((m+1)*n+2*r,(f+1)*n)),f<a-1?m+f&1?this._jigsawHBLineTo(l,m+1,f+1,!0):this._jigsawHTLineTo(l,m+1,f+1,!0):(l.lineTo((m+1)*n,(f+1)*n+2*r),l.lineTo(m*n,(f+1)*n+2*r)),m?m+f&1?this._jigsawVRLineTo(l,m,f+1,!0):this._jigsawVLLineTo(l,m,f+1,!0):(l.lineTo(m*n-2*r,(f+1)*n),l.lineTo(m*n-2*r,f*n)),l.closePath(),l.clip(),l.drawImage(o,0,0),l.stroke(),l.restore(),h.clearRect(0,0,s.width,s.height),h.drawImage(u,m*n-p,f*n-p,s.width,s.height,0,0,s.width,s.height),g.push({i:m,j:f,top:f*n-p,left:m*n-p,size:s.width,src:s.toDataURL("image/png")});this.setState({imgs:g,allSrc:o.toDataURL("image/png")});case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"_getImgCanvas",value:function(){var e=Object(f.a)(d.a.mark(function e(){var t,n,a,i,r,c,o;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.cutData,n=t.imgSrc,a=t.pieceSize,i=t.pieceRowCount,r=t.pieceColumnCount,e.next=3,j(n);case 3:return c=e.sent,(o=document.createElement("canvas")).width=a*r,o.height=a*i,o.getContext("2d").drawImage(c,0,0,o.width,o.height),e.abrupt("return",o);case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"_jigsawLineTo",value:function(e,t){e(76,0),t(84.6,0,91.7,7,91.7,15.7),e(91.7,17.3),t(91.7,21.2,90.7,24.9,88.9,28.4),t(86.5,33.3,85.4,39,86.3,45.1),t(88.2,57.5,98.4,67.3,110.9,68.6),t(127.8,70.4,142,57.3,142,40.8),t(142,36.4,141,32.2,139.1,28.5),t(137.4,25,136.3,21.3,136.3,17.4),e(136.3,15.8),t(136.3,7.2,143.3,0,152,0),e(228,0)}},{key:"_jigsawLineToWithTransform",value:function(e,t){return this._jigsawLineTo(function(n,a){return e.lineTo.apply(e,Object(g.a)(t(n,a)))},function(n,a,i,r,c,o){return e.bezierCurveTo.apply(e,Object(g.a)(t(n,a)).concat(Object(g.a)(t(i,r)),Object(g.a)(t(c,o))))})}},{key:"_jigsawHTLineTo",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.props.cutData.pieceSize,r=i/228,c=(t-1)*i,o=n*i;this._jigsawLineToWithTransform(e,a?function(e,t){return[i-e*r+c,-t*r+o]}:function(e,t){return[e*r+c,-t*r+o]})}},{key:"_jigsawVRLineTo",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.props.cutData.pieceSize,r=i/228,c=t*i,o=(n-1)*i;this._jigsawLineToWithTransform(e,a?function(e,t){return[t*r+c,i-e*r+o]}:function(e,t){return[t*r+c,e*r+o]})}},{key:"_jigsawHBLineTo",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.props.cutData.pieceSize,r=i/228,c=(t-1)*i,o=n*i;this._jigsawLineToWithTransform(e,a?function(e,t){return[i-e*r+c,t*r+o]}:function(e,t){return[e*r+c,t*r+o]})}},{key:"_jigsawVLLineTo",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.props.cutData.pieceSize,r=i/228,c=t*i,o=(n-1)*i;this._jigsawLineToWithTransform(e,a?function(e,t){return[-t*r+c,i-e*r+o]}:function(e,t){return[-t*r+c,e*r+o]})}}]),t}(a.Component),E=n(34),O=n.n(E),L={img:{minWidth:100}},R=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(i)))).state={imgSrc:O.a,pieceSize:200,pieceRowCount:2,pieceColumnCount:3,lineWidth:3,strokeStyle:"rgba(0, 0, 0, 0.35)",cutData:{imgSrc:O.a,pieceSize:200,pieceRowCount:2,pieceColumnCount:3,lineWidth:3,strokeStyle:"rgba(0, 0, 0, 0.35)"}},n._handleClickCut=function(){var e=Object(p.a)(Object(p.a)(n)).state,t=e.imgSrc,a=e.pieceSize,i=e.pieceRowCount,r=e.pieceColumnCount,c=e.lineWidth,o=e.strokeStyle;a=_(a,0),i=_(i,0),r=_(r,0),c=_(c,0),n.setState({pieceSize:a,pieceRowCount:i,pieceColumnCount:r,lineWidth:c,cutData:{imgSrc:t,pieceSize:a,pieceRowCount:i,pieceColumnCount:r,lineWidth:c,strokeStyle:o}})},n._handleChangeFile=function(e){var t=e.target.files,a=new FileReader;a.onload=function(){n.setState({imgSrc:a.result})},a.readAsDataURL(t[0])},n._handleChangePieceSize=function(e){var t=e.target.value;n.setState({pieceSize:t})},n._handleChangePieceRowCount=function(e){var t=e.target.value;n.setState({pieceRowCount:t})},n._handleChangePieceColumnCount=function(e){var t=e.target.value;n.setState({pieceColumnCount:t})},n._handleChangeLineWidth=function(e){var t=e.target.value;n.setState({lineWidth:t})},n._handleChangeStrokeStyle=function(e){var t=e.target.value;n.setState({strokeStyle:t})},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state,t=e.imgSrc,n=e.pieceSize,a=e.pieceRowCount,r=e.pieceColumnCount,c=e.lineWidth,o=e.strokeStyle,u=e.cutData;return i.a.createElement("section",null,i.a.createElement("h1",null,"\u62fc\u56fe\u5207\u56fe"),i.a.createElement("div",null,"\u8981\u5207\u7684\u56fe\u7247\uff1a",i.a.createElement("img",{src:t,alt:"\u56fe\u7247",style:L.img}),i.a.createElement("input",{type:"file",accept:"image/*",onChange:this._handleChangeFile})),i.a.createElement("div",null,"\u6bcf\u4e00\u7247\u7684\u5927\u5c0f\uff1a",i.a.createElement("input",{type:"number",value:"".concat(n),onChange:this._handleChangePieceSize})),i.a.createElement("div",null,"\u884c\u6570\uff1a",i.a.createElement("input",{type:"number",value:"".concat(a),onChange:this._handleChangePieceRowCount})),i.a.createElement("div",null,"\u5217\u6570\uff1a",i.a.createElement("input",{type:"number",value:"".concat(r),onChange:this._handleChangePieceColumnCount})),i.a.createElement("div",null,"\u7ebf\u5bbd\uff1a",i.a.createElement("input",{type:"number",value:"".concat(c),onChange:this._handleChangeLineWidth})),i.a.createElement("div",null,"\u7ebf\u7684\u989c\u8272\uff1a",i.a.createElement("input",{value:"".concat(o),onChange:this._handleChangeStrokeStyle})),i.a.createElement("div",null,i.a.createElement("button",{onClick:this._handleClickCut},"\u5207\u4e00\u5207")),u&&i.a.createElement(k,{key:JSON.stringify(u),cutData:u}))}}]),t}(a.Component),z=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return i.a.createElement(R,null)}}]),t}(a.Component);c.a.render(i.a.createElement(z,null),document.getElementById("root"))},34:function(e,t,n){e.exports=n.p+"static/media/example.bca1d26f.jpg"},67:function(e,t,n){e.exports=n(126)},78:function(e,t){},80:function(e,t){}},[[67,2,1]]]);
//# sourceMappingURL=main.0e16d02e.chunk.js.map